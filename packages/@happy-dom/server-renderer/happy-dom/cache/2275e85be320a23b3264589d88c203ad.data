"use strict";(self.legacyJsonp=self.legacyJsonp||[]).push([[51331],{587260:function(e,r,t){var n=t(297934);r.Z=function(){var e=(0,n.Z)();return!!e.isAuth&&e.isPartner}},51331:function(e,r,t){t.d(r,{FE:function(){return V},NM:function(){return H},lG:function(){return W}});var n=t(258712),i=t(284987),u=t(587260),a=t(803242),o=t(297934),s=t(992114);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function f(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?l(Object(t),!0).forEach(function(r){m(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function m(e,r,t){var n;return(n=function(e,r){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=c(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(r,"string"),(r="symbol"==c(n)?n:n+"")in e)?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function d(e,r,t,n,i,u,a){try{var o=e[u](a),s=o.value}catch(e){return void t(e)}o.done?r(s):Promise.resolve(s).then(n,i)}function p(e){return function(){var r=this,t=arguments;return new Promise(function(n,i){var u=e.apply(r,t);function a(e){d(u,n,i,a,o,"next",e)}function o(e){d(u,n,i,a,o,"throw",e)}a(void 0)})}}function v(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}var y=function(){var e,r,t=(0,o.Z)(),i=(0,u.Z)(),c=function(e){if(Array.isArray(e))return e}(e=(0,n.useState)({isReady:!1}))||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,i,u,a,o=[],s=!0,c=!1;try{u=(t=t.call(e)).next,!1;for(;!(s=(n=u.call(t)).done)&&(o.push(n.value),o.length!==r);s=!0);}catch(e){c=!0,i=e}finally{try{if(!s&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}(e,2)||function(e,r){if(e){if("string"==typeof e)return v(e,2);var t=({}).toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?v(e,r):void 0}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),l=c[0],d=c[1],y=(0,n.useCallback)((r=p(regeneratorRuntime.mark(function e(r){var t,n,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.entityId,n=r.actingBusinessId,u=r.favorites,!i){e.next=5;break}return e.next=4,(0,a.yo)({entityId:t,actingBusinessId:n,favorites:u});case 4:d(function(e){var r,t=f(f({},e),{},{actingBusinessId:n});return u&&(t.favoriteAdAccounts={favoriteAdAccountsMap:f(f({},(null==(r=e.favoriteAdAccounts)?void 0:r.favoriteAdAccountsMap)||{}),{},m({},u.actingBusinessId,{advertiserId:u.adAccounts}))}),t});case 5:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)}),[i]);return(0,n.useEffect)(function(){i&&t.isAuth&&!l.isReady&&p(regeneratorRuntime.mark(function e(){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=!1,e.prev=1,e.next=4,(0,a.SF)({entityId:t.id});case 4:n=e.sent,d(function(e){return f(f({},e),n)}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),r=!0;case 11:return e.prev=11,(0,s.nP)("globalAccountSwitcher.getFavoriteAdAccounts",{sampleRate:1,tags:{businessId:t.id,hasError:r}}),d(function(e){return f(f({},e),{},{isReady:!0})}),e.finish(11);case 15:case"end":return e.stop()}},e,null,[[1,8,11,15]])}))()},[l.isReady,i,t]),{accountSwitcherConfig:l,setConfig:y}},g=t(545007),b=t(976162),h=t(661545),_=t(797332),w=(0,h.P1)(_.Z,function(e){var r=e.viewerIsProfileOwnerOrProfileManager;return null!=r?r:void 0}),A=t(827491),S=t(488879),I=t(975395);function O(e,r,t,n,i,u,a){try{var o=e[u](a),s=o.value}catch(e){return void t(e)}o.done?r(s):Promise.resolve(s).then(n,i)}var P=function(){var e=(0,o.Z)(),r=(0,n.useRef)(e);r.current=e;var t=(0,g.I0)(),i=(0,A.Z)(),u=(0,n.useRef)(i);u.current=i;var s=(0,g.v9)(w),c=(null==s?void 0:s.data)||void 0,l=(0,n.useRef)(c);l.current=c,(0,n.useEffect)(function(){var e,n;(e=regeneratorRuntime.mark(function e(){var n,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.current.isAuth&&void 0===s.data)){e.next=5;break}return e.next=3,(0,a.bG)({user_id:r.current.id});case 3:void 0!==(n=e.sent)&&void 0===l.current&&(o=(0,S.D3)(r.current,null!=(i=null==n?void 0:n.id)?i:"",u)||r.current.isAuth&&r.current.username===(null==n?void 0:n.username),t((0,b.Z)(!!o)));case 5:case"end":return e.stop()}},e)}),n=function(){var r=this,t=arguments;return new Promise(function(n,i){var u=e.apply(r,t);function a(e){O(u,n,i,a,o,"next",e)}function o(e){O(u,n,i,a,o,"throw",e)}a(void 0)})},function(){return n.apply(this,arguments)})()},[r,l,t,u,s]);var f=(0,I.rc)(c);return{viewerIsProfileOwnerOrProfileManagerData:c,previousIsViewerProfileOwnerOrProfileManager:f}},R=t(937201),N=t(19963),C=t(218291),x=t(890360),E=t(50113),U=t(967312),B=t(857147),j=t(867885),k=t(364935),T=t(19035);function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,r,t,n,i,u,a){try{var o=e[u](a),s=o.value}catch(e){return void t(e)}o.done?r(s):Promise.resolve(s).then(n,i)}function F(e){return function(){var r=this,t=arguments;return new Promise(function(n,i){var u=e.apply(r,t);function a(e){M(u,n,i,a,o,"next",e)}function o(e){M(u,n,i,a,o,"throw",e)}a(void 0)})}}function G(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,i,u,a,o=[],s=!0,c=!1;try{if(u=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;s=!1}else for(;!(s=(n=u.call(t)).done)&&(o.push(n.value),o.length!==r);s=!0);}catch(e){c=!0,i=e}finally{try{if(!s&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}(e,r)||function(e,r){if(e){if("string"==typeof e)return z(e,r);var t=({}).toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?z(e,r):void 0}}(e,r)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}var L=(0,C.Z)("AccountSwitcherContext"),D=L.Provider,H=L.get,W=function(e){return e.search&&(0,B.mB)(e.search).advertiserId},V=function(e){var r,t=e.children,s=(0,i.TH)(),c=(0,i.$B)().params,l=c.userBizId,f=c.businessHierarchyId,m=c.advertiserId,d=c.username,p=(0,k.Z)().catalogId,v=W(s),g=(0,o.Z)(),b=P(),h=b.viewerIsProfileOwnerOrProfileManagerData,_=b.previousIsViewerProfileOwnerOrProfileManager,w=(0,(0,U.r)().checkExperiment)("web_m10n_business_access_catalogs").anyEnabled,A=G((0,n.useState)(""),2),S=A[0],O=A[1],C=G((0,n.useState)(null),2),B=C[0],M=C[1],z=G((0,n.useState)(!1),2),L=z[0],H=z[1],V=G((0,n.useState)(null),2),$=V[0],q=V[1],J=new URLSearchParams(s.search),Y=G((0,n.useState)(J.has("actingBusinessId")?null:{id:g.isAuth&&g.id||"",name:g.isAuth&&g.fullName||"",img:g.isAuth&&g.imageMediumUrl||""}),2),K=Y[0],Q=Y[1],X=G((0,n.useState)(!1),2),ee=X[0],er=X[1],et=(0,u.Z)(),en=(0,N.u)().logContextEvent,ei=y(),eu=ei.accountSwitcherConfig,ea=ei.setConfig;(0,n.useEffect)(function(){f?O(f):O("")},[f]);var eo=(0,n.useCallback)((r=F(regeneratorRuntime.mark(function e(r){var t,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.id,n=r.username,e.next=3,(0,a.bG)({user_id:t,username:n});case 3:(i=e.sent)&&q({type:t?R.Oz.BUSINESS_ACCOUNT:R.Oz.PROFILE,id:t||i.id,name:i.full_name,img:i.image_medium_url,username:n,ownerImg:i.image_medium_url,ownerName:i.full_name,actingBusinessFullName:(null==K?void 0:K.name)||i.full_name}),er(!1);case 6:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)}),[K]),es=(0,I.rc)(d);(0,n.useEffect)(function(){var e=g.isAuth?g.username:void 0;(0,E.Z)(s)&&$&&es!==d&&d===e&&(eo({username:e}),Q({id:g.isAuth&&g.id||"",name:g.isAuth&&g.fullName||"",img:g.isAuth&&g.imageMediumUrl||""}),M({type:R.nt,id:g.isAuth?g.id:void 0}))},[s,es,eo,$,d,g]),(0,n.useEffect)(function(){var e,r,t=(e=F(regeneratorRuntime.mark(function e(r){var t,n,i,u,a,o,c,l,f,m;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.businessId,n=r.assetId,t){e.next=4;break}return er(!1),e.abrupt("return");case 4:if(i=w&&(0,x.Bg)(s)?"CATALOG":"AD_ACCOUNT",e.prev=5,u={asset:{name:""},type:i},!g.isAuth){e.next=19;break}return e.next=10,(0,j.pI)({businessId:(null==K?void 0:K.id)||g.id,assetIds:[n],resourceType:i});case 10:if(e.t0=e.sent,e.t0){e.next=13;break}e.t0={};case 13:var d,p,v;f=(l=(c=void 0===(o=(a=void 0===(a=e.t0.data)?{}:a).data)?(d={},p=n,v=u,(p=function(e){var r=function(e,r){if("object"!=Z(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=Z(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==Z(r)?r:r+""}(p))in d?Object.defineProperty(d,p,{value:v,enumerable:!0,configurable:!0,writable:!0}):d[p]=v,d):o)[n]||u).asset,m=l.type,q({id:n,name:"CATALOG"===i?c[n].owner.full_name:f.name,img:c[n].owner.image_medium_url,type:m,ownerImg:c[n].owner.image_medium_url,ownerName:c[n].owner.full_name,actingBusinessFullName:(null==K?void 0:K.name)||c[n].owner.full_name});case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(5),q({id:g.isAuth&&g.id||"",name:g.isAuth&&g.fullName||"",img:g.isAuth&&g.imageMediumUrl||"",type:R.Oz.BUSINESS_ACCOUNT,ownerImg:g.isAuth&&g.imageMediumUrl||"",ownerName:g.isAuth&&g.fullName||"",actingBusinessFullName:g.isAuth&&g.fullName||""});case 24:er(!1);case 25:case"end":return e.stop()}},e,null,[[5,21]])})),function(r){return e.apply(this,arguments)}),n=(r=F(regeneratorRuntime.mark(function e(r){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.id,e.next=3,(0,a.p)({hierarchyId:t});case 3:n=e.sent,q({id:t,name:null!=n&&n.data?n.data.name:"",img:null!=n&&n.data?n.data.img_medium_url:"",type:R.Oz.BUSINESS_HIERARCHY,ownerImg:null!=n&&n.data?n.data.img_medium_url:"",ownerName:null!=n&&n.data?n.data.name:"",actingBusinessFullName:null!=n&&n.data?n.data.name:""}),er(!1);case 6:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)});if(g.isAuth&&et){var i=$&&$.username&&$.username!==d,u=!0===h&&h!==_;if((!$||i||u)&&!ee&&K){var o=(0,x.z6)(s)||(0,x.h3)(s),c=m||!!v&&!o||(0,x.Bg)(s)&&w;er(!0),f?n({id:f}):l?eo({id:l}):(0,E.Z)(s)&&d&&h?eo({username:d}):c?t({businessId:g.id,assetId:m||v||p||""}):$&&$.id===g.id||(q({type:R.Oz.BUSINESS_ACCOUNT,id:g.id||"",name:g.fullName||"",img:g.imageMediumUrl||"",ownerImg:g.imageMediumUrl||"",ownerName:g.fullName||"",actingBusinessFullName:g.fullName||""}),er(!1))}}},[$,g,f,l,d,m,v,K,et,s,eo,ee,h,_,p,w]);var ec=(0,n.useMemo)(function(){return{activePanel:B,selectedHierarchyId:S,switcherOpen:L,openAccountSwitcher:function(){if(en({event_type:101,view_type:608,component:14346}),!B)if((0,x.z6)(s))M({type:R.v8});else{var e=new URLSearchParams(s.search).get("actingBusinessId");M({type:R.nt,id:null!=e?e:null==K?void 0:K.id})}H(!0)},closeAccountSwitcher:function(){M($&&!(0,x.z6)(s)?{type:R.nt,id:null==K?void 0:K.id}:{type:R.v8}),H(!1)},openAssetPanel:function(e){M({type:R.nt,id:e})},closeAssetPanel:function(){M($&&!(0,x.z6)(s)?{type:R.nt,id:null==K?void 0:K.id}:{type:R.v8})},activateBusinessPanel:function(){M({type:R.v8})},actingBusiness:K,selectedAccount:$,setSelectedAccount:q,setActingBusiness:Q,accountSwitcherConfig:eu,setConfig:ea}},[B,S,L,K,$,eu,ea,en,s]);return(0,T.jsx)(D,{value:ec,children:t})}},803242:function(e,r,t){t.d(r,{IT:function(){return y},SF:function(){return _},WP:function(){return g},bG:function(){return h},p:function(){return b},yo:function(){return w}});var n,i,u,a,o=t(343882),s=t(711840),c=t(578373),l=t(937201),f=t(397657),m=t(904091);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,r,t,n,i,u,a){try{var o=e[u](a),s=o.value}catch(e){return void t(e)}o.done?r(s):Promise.resolve(s).then(n,i)}function v(e){return function(){var r=this,t=arguments;return new Promise(function(n,i){var u=e.apply(r,t);function a(e){p(u,n,i,a,o,"next",e)}function o(e){p(u,n,i,a,o,"throw",e)}a(void 0)})}}var y=function(e){return{id:e.id,entity_type:l.Oz.BUSINESS_ACCOUNT,requires_mfa_for_roles:e.requires_mfa_for_roles,user:{id:e.user.id,entity_type:l.Oz.USER_ACCOUNT,username:e.user.username,email:e.user.email,full_name:e.user.full_name,image_small_url:e.user.image_small_url,image_medium_url:e.user.image_medium_url}}},g=function(e){return{id:e.id,entity_type:l.Oz.BUSINESS_ACCOUNT,user:{id:e.id,entity_type:l.Oz.USER_ACCOUNT,username:e.username,email:e.email,full_name:e.fullName,image_small_url:e.imageSmallUrl,image_medium_url:e.imageMediumUrl}}},b=(n=v(regeneratorRuntime.mark(function e(r){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.hierarchyId,e.next=3,(0,f.Z)({url:"ads/v4/business_access/business_hierarchy/".concat(t,"/")});case 3:return n=e.sent,e.abrupt("return",n.resource_response);case 5:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),h=(i=v(regeneratorRuntime.mark(function e(r){var t,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.user_id,!(!(n=r.username)&&!t)){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,c.Z.create("UserResource",{user_id:t,username:n}).callGet();case 5:return i=e.sent.resource_response.data,e.abrupt("return",i);case 8:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)}),_=(u=v(regeneratorRuntime.mark(function e(r){var t,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.entityId,e.next=3,(0,o.Z)([{entity_type:"BIZ_USER",entity_id:t,property_keys:["GLOBAL_ACCOUNT_SWITCHER_CONFIG"]}]);case 3:if((n=e.sent[0])&&n.properties){e.next=7;break}return e.abrupt("return",{});case 7:return i=n.properties.GLOBAL_ACCOUNT_SWITCHER_CONFIG,e.abrupt("return",i);case 9:case"end":return e.stop()}},e)})),function(e){return u.apply(this,arguments)}),w=(a=v(regeneratorRuntime.mark(function e(r){var t,n,i,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:var a,o,c;if(t=r.entityId,n=r.actingBusinessId,i=r.favorites,u={},(0,m.k)(n)||(u.actingBusinessId=n),i&&(u.favoriteAdAccounts={favoriteAdAccountsMap:(a={},o=i.actingBusinessId,c={advertiserId:i.adAccounts},(o=function(e){var r=function(e,r){if("object"!=d(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=d(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==d(r)?r:r+""}(o))in a?Object.defineProperty(a,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[o]=c,a)}),!(Object.keys(u).length>0)){e.next=7;break}return e.next=7,(0,s.Z)([{entity_type:"BIZ_USER",entity_id:t,properties:{GLOBAL_ACCOUNT_SWITCHER_CONFIG:u}}]);case 7:case"end":return e.stop()}},e)})),function(e){return a.apply(this,arguments)})},976162:function(e,r,t){t.d(r,{Z:function(){return n}});function n(e){return{type:"UPDATE_VIEWER_IS_PROFILE_OWNER_OR_PROFILE_MANAGER",payload:e}}},797332:function(e,r){r.Z=function(e){var r=e.businessAccess;return null!=r?r:{}}},364935:function(e,r,t){t.d(r,{Z:function(){return i}});var n=t(284987);function i(){var e=(0,n.UO)();return{catalogId:e.catalog_id,feedProfileId:e.feed_profile_id,workflowId:e.workflow_id,productGroupId:e.product_group_id,eventTypeId:e.event_type_id,supplementalFeedProfileId:e.supplemental_feed_profile_id,mnCatalogId:e.mn_catalog_id,mnProductGroupId:e.mn_product_group_id}}}}]);